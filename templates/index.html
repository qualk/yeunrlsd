{% extends 'partials/layout.html' %}

{% set back_hidden = true %}
{% set back_onclick = "goBack()" %}
{% set cart_onclick = "toggleCart()" %}

{% block title %}[yeunrlsd]{% endblock %}

{% block description %}ye unreleased music, inspired by yeezy.com, built with Flask.{% endblock %}

{% block extra_head %}
{% for album in albums[:6] %}
<link rel="preload" as="image" href="{{ album.image }}">
{% endfor %}
{% endblock %}

{% block main %}
<div id="album-grid" class="product-grid" role="list" aria-label="Album list">
    {% for album in albums %}
    <div class="product-item" data-on-click="@get('/p/{{ album.id }}')" role="listitem" tabindex="0" aria-label="View details for {{ album.name }}">
        <img src="{{ album.image }}" alt="{{ album.name }}" class="product-image" loading="lazy">
        <p class="product-name">{{ album.name }}</p>
    </div>
    {% endfor %}
</div>

<div id="album-detail" class="product-detail hidden" aria-live="polite" aria-atomic="true">
        <!-- Will be populated by Datastar -->
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Register service worker
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('/static/sw.js')
            .then(registration => {
            console.log('SW registered: ', registration);
        })
        .catch(registrationError => {
            console.log('SW registration failed: ', registrationError);
        });
    });
}
</script>
{% endblock %}